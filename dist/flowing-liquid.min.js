/*!
  * flowing-liquid v0.2.1
  * (c) 2018 Bowen<Github: lbwa>
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FlowingLiquid=e()}(this,function(){"use strict";class t{constructor({canvasWidth:t,canvasHeight:e,waveWidth:i=.055,waveHeight:s=6,xOffset:n=0,speed:a=.04,colors:h=["#DBB77A","#BF8F3B"]}={}){this.points=[],this.startX=0,this.canvasWidth=t,this.canvasHeight=e,this.waveWidth=i,this.waveHeight=s,this.xOffset=n,this.speed=a,this.colors=h}getChartColor(t){const e=this.canvasWidth/2,i=t.createLinearGradient(e,e,e,this.canvasHeight);return i.addColorStop(0,this.colors[0]),i.addColorStop(1,this.colors[1]),i}render(t){const e=this.points;t.save(),t.beginPath(),this.points.forEach(e=>{t.lineTo(e.x,e.y)}),t.lineTo(this.canvasWidth,this.canvasHeight),t.lineTo(this.startX,this.canvasHeight),t.lineTo(e[0].x,e[0].y),t.fillStyle=this.getChartColor(t),t.fill(),t.restore()}createPointsMap({currentLine:t}){this.points=[];const{startX:e,waveHeight:i,waveWidth:s,canvasWidth:n,canvasHeight:a,xOffset:h}=this;for(let r=e;r<e+n;r+=20/n){const n=Math.sin((e+r)*s+h);this.points.push({x:r,y:a*(1-t/100)+n*i})}this.xOffset+=this.speed}}return class{constructor({el:e,canvasWidth:i=500,canvasHeight:s=500,waterline:n=60,colors:a=["#F39C6B","#A0563B","rgba(243, 156, 107, 0.48)","rgba(160, 86, 59, 0.48)"],font:h={bold:!0,color:"",size:50,family:"Microsoft Yahei",text:""}}){if("string"!=typeof e)throw new Error("Parameter el should be a String !");const r=this.canvas=document.querySelector(e);this.canvasWidth=r.width=i,this.canvasHeight=r.height=s,this.hasRenderedContainer=!1,this.currentLine=0,this.waterline=n<=100?n:100,this.colors=a,this.font=h,this.waves=[new t({canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight,waveWidth:.055,waveHeight:4,colors:[this.colors[0],this.colors[1]],xOffset:0,speed:.04}),new t({canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight,waveWidth:.04,waveHeight:7,colors:[this.colors[2],this.colors[3]],xOffset:2,speed:.02})]}render(t=5,e=!1){const i=this.canvas.getContext("2d");i.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.hasRenderedContainer||this.drawContainer(i),this.currentLine<this.waterline&&(this.currentLine+=1),this.waves.forEach((s,n)=>{s.createPointsMap({currentLine:this.currentLine+n*t}),s.render(i),e&&this.renderText(i,`${this.currentLine}`)}),window.requestAnimationFrame(this.render.bind(this,t,e))}renderText(t,e){const i=this.font,s=`${i.bold?"bold":""} `+`${i.size||50}px `+`${i.family||"Microsoft Yahei"}`;t.font=s,t.fillStyle=i.color||"rgba(160, 86, 60, 1)",t.textAlign="center",t.fillText(i.text?i.text:e,this.canvasWidth/2,this.canvasHeight/2+this.font.size/2)}drawContainer(t){const e=this.canvasWidth/2,i=e-4;t.lineWidth=4,t.beginPath(),t.arc(e,e,i,0,2*Math.PI),t.strokeStyle="rgba(186, 165, 130, 0.3)",t.stroke(),t.clip(),this.hasRenderedContainer=!0}}});
