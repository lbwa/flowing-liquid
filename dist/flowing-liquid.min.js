/*!
  * flowing-liquid v0.4.0
  * (c) 2018 Bowen<Github: lbwa>
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FlowingLiquid=e()}(this,function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=function(){function e(i){var n=i.canvasWidth,r=i.canvasHeight,a=i.waveWidth,o=void 0===a?.055:a,s=i.waveHeight,h=void 0===s?6:s,c=i.xOffset,l=void 0===c?0:c,d=i.speed,f=void 0===d?.04:d,v=i.colors,u=void 0===v?["#DBB77A","#BF8F3B"]:v;t(this,e),this.points=[],this.startX=0,this.canvasWidth=n,this.canvasHeight=r,this.waveWidth=o,this.waveHeight=h,this.xOffset=l,this.speed=f,this.colors=u}return i(e,[{key:"createFillColor",value:function(t){if("string"==typeof this.colors)return this.colors;var e=this.canvasWidth/2,i=t.createLinearGradient(e,e,e,this.canvasHeight);return i.addColorStop(0,this.colors[0]),i.addColorStop(1,this.colors[1]),i}},{key:"render",value:function(t){var e=this.points;t.save(),t.beginPath(),this.points.forEach(function(e){t.lineTo(e.x,e.y)}),t.lineTo(this.canvasWidth,this.canvasHeight),t.lineTo(this.startX,this.canvasHeight),t.lineTo(e[0].x,e[0].y),t.fillStyle=this.createFillColor(t),t.fill(),t.restore()}},{key:"createPointsMap",value:function(t){var e=t.currentLine;this.points=[];for(var i=this.startX,n=this.waveHeight,r=this.waveWidth,a=this.canvasWidth,o=this.canvasHeight,s=this.xOffset,h=i;h<i+a;h+=20/a){var c=Math.sin((i+h)*r+s);this.points.push({x:h,y:o*(1-e/100)+c*n})}this.xOffset=this.xOffset>2*Math.PI?0:this.xOffset+this.speed}}]),e}();return function(){function e(i){var a=this,o=i.el,s=i.canvasWidth,h=void 0===s?500:s,c=i.canvasHeight,l=void 0===c?500:c,d=i.waterline,f=void 0===d?60:d,v=i.flowingBody,u=void 0===v?[{waveWidth:.055,waveHeight:4,colors:["#F39C6B","#A0563B"],xOffset:0,speed:.08},{waveWidth:.04,waveHeight:7,colors:["rgba(243, 156, 107, 0.48)","rgba(160, 86, 59, 0.48)"],xOffset:2,speed:.02}]:v,g=i.font,y=void 0===g?{bold:!0,color:"",size:50,family:"Microsoft Yahei",text:""}:g,b=i.background,p=void 0===b?{color:"rgba(186, 165, 130, 0.3)",style:"stroke"}:b;if(t(this,e),"string"!=typeof o)throw new Error("Parameter el should be a String !");var w=this.canvas=document.querySelector(o);this.canvasWidth=w.width=h,this.canvasHeight=w.height=l,this.hasRenderedContainer=!1,this.currentLine=0,this.waterline=f<=100?f:100,this.font=y,this.background=p,this.waves=u.map(function(t){return new r(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),r.forEach(function(e){n(t,e,i[e])})}return t}({canvasWidth:a.canvasWidth,canvasHeight:a.canvasHeight},t))}),this.canvas.style.borderRadius="50%"}return i(e,[{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.hasRenderedContainer||this.renderContainer(n,this.background),this.currentLine<this.waterline&&(this.currentLine+=1),this.waves.forEach(function(r,a){r.createPointsMap({currentLine:t.currentLine+a*e}),r.render(n),i&&t.renderText(n,"".concat(t.currentLine))}),window.requestAnimationFrame(this.render.bind(this,e,i,this.background))}},{key:"renderText",value:function(t,e){var i=this.font,n="".concat(i.bold?"bold":""," ")+"".concat(i.size||50,"px ")+"".concat(i.family||"Microsoft Yahei");t.font=n,t.fillStyle=i.color||"#24292e",t.textAlign="center",t.fillText(i.text?i.text:e,this.canvasWidth/2,this.canvasHeight/2+(this.font.size||50)/2)}},{key:"renderContainer",value:function(t,e){var i=this.canvasWidth/2,n="fill"===e.style?0:4,r=i-n;t.lineWidth=n,t.beginPath(),t.arc(i+.5,i+.5,r,0,2*Math.PI),this.createContainerBackground(t,e),"stroke"===e.style&&(this.hasRenderedContainer=!0)}},{key:"createContainerBackground",value:function(t,e){var i=e.color,n=e.style;return"stroke"===n?(t.strokeStyle=i||"rgba(186, 165, 130, 0.3)",void t.stroke()):"fill"===n?(t.fillStyle=i||"rgba(186, 165, 130, 0.3)",void t.fill()):void 0}}]),e}()});
