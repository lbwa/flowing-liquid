/*!
  * flowing-liquid v0.2.2
  * (c) 2018 Bowen<Github: lbwa>
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FlowingLiquid=e()}(this,function(){"use strict";function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class e{constructor({canvasWidth:t,canvasHeight:e,waveWidth:i=.055,waveHeight:s=6,xOffset:n=0,speed:r=.04,colors:a=["#DBB77A","#BF8F3B"]}){this.points=[],this.startX=0,this.canvasWidth=t,this.canvasHeight=e,this.waveWidth=i,this.waveHeight=s,this.xOffset=n,this.speed=r,this.colors=a}createFillColor(t){if("string"==typeof this.colors)return this.colors;const e=this.canvasWidth/2,i=t.createLinearGradient(e,e,e,this.canvasHeight);return i.addColorStop(0,this.colors[0]),i.addColorStop(1,this.colors[1]),i}render(t){const e=this.points;t.save(),t.beginPath(),this.points.forEach(e=>{t.lineTo(e.x,e.y)}),t.lineTo(this.canvasWidth,this.canvasHeight),t.lineTo(this.startX,this.canvasHeight),t.lineTo(e[0].x,e[0].y),t.fillStyle=this.createFillColor(t),t.fill(),t.restore()}createPointsMap({currentLine:t}){this.points=[];const{startX:e,waveHeight:i,waveWidth:s,canvasWidth:n,canvasHeight:r,xOffset:a}=this;for(let o=e;o<e+n;o+=20/n){const n=Math.sin((e+o)*s+a);this.points.push({x:o,y:r*(1-t/100)+n*i})}this.xOffset=this.xOffset>2*Math.PI?0:this.xOffset+this.speed}}return class{constructor({el:i,canvasWidth:s=500,canvasHeight:n=500,waterline:r=60,flowingBody:a=[{waveWidth:.055,waveHeight:4,colors:["#F39C6B","#A0563B"],xOffset:0,speed:.08},{waveWidth:.04,waveHeight:7,colors:["rgba(243, 156, 107, 0.48)","rgba(160, 86, 59, 0.48)"],xOffset:2,speed:.02}],font:o={bold:!0,color:"",size:50,family:"Microsoft Yahei",text:""}}){if("string"!=typeof i)throw new Error("Parameter el should be a String !");const h=this.canvas=document.querySelector(i);this.canvasWidth=h.width=s,this.canvasHeight=h.height=n,this.hasRenderedContainer=!1,this.currentLine=0,this.waterline=r<=100?r:100,this.font=o,this.waves=a.map(i=>new e(function(e){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{},n=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),n.forEach(function(i){t(e,i,s[i])})}return e}({canvasWidth:this.canvasWidth,canvasHeight:this.canvasHeight},i)))}render(t=5,e=!1){const i=this.canvas.getContext("2d");i.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.hasRenderedContainer||this.drawContainer(i),this.currentLine<this.waterline&&(this.currentLine+=1),this.waves.forEach((s,n)=>{s.createPointsMap({currentLine:this.currentLine+n*t}),s.render(i),e&&this.renderText(i,`${this.currentLine}`)}),window.requestAnimationFrame(this.render.bind(this,t,e))}renderText(t,e){const i=this.font,s=`${i.bold?"bold":""} `+`${i.size||50}px `+`${i.family||"Microsoft Yahei"}`;t.font=s,t.fillStyle=i.color||"rgba(160, 86, 60, 1)",t.textAlign="center",t.fillText(i.text?i.text:e,this.canvasWidth/2,this.canvasHeight/2+this.font.size/2)}drawContainer(t){const e=this.canvasWidth/2,i=e-4;t.lineWidth=4,t.beginPath(),t.arc(e,e,i,0,2*Math.PI),t.strokeStyle="rgba(186, 165, 130, 0.3)",t.stroke(),t.clip(),this.hasRenderedContainer=!0}}});
